<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Progress Bar</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        .progress-step {
            width: 100%;
        }
        .progress-bar {
            transition: width 0.3s ease;
        }
        .completed-step {
            background-color: #48bb78; /* Green */
        }
        .upcoming-step {
            border-color: #cbd5e0; /* Light Gray */
        }
        .completed-bar {
            background-color: #68d391; /* Light Green */
        }
        .upcoming-bar {
            background-color: #e2e8f0; /* Gray */
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center h-screen">
    <div class="max-w-xl mx-auto my-4 border-b-2 pb-4">
        <div class="flex pb-3" id="progress-steps">
            <!-- Progress steps will be dynamically inserted here -->
        </div>
        <div class="flex text-xs content-center text-center" id="progress-labels">
            <!-- Progress labels will be dynamically inserted here -->
        </div>
    </div>

    <script>
        // Sample data from the database
        const data = [
            { name: 'Invitation received', points: 100 },
            { name: 'Personal details', points: 250 },
            { name: 'Application details', points: 500 },
            { name: 'Confirmation', points: 1000 }
        ];

        // Function to generate the progress bar
        function generateProgressBar(data, currentPoints) {
            const progressSteps = document.getElementById('progress-steps');
            const progressLabels = document.getElementById('progress-labels');

            // Clear existing content
            progressSteps.innerHTML = '';
            progressLabels.innerHTML = '';

            let accumulatedPoints = 0;
            data.forEach((level, index) => {
                accumulatedPoints += level.points;
                const isCompleted = currentPoints >= accumulatedPoints;

                // Create progress step
                const stepDiv = document.createElement('div');
                stepDiv.classList.add('flex-1');

                const stepCircle = document.createElement('div');
                stepCircle.classList.add('w-10', 'h-10', 'mx-auto', 'rounded-full', 'text-lg', 'flex', 'items-center', 'justify-center');
                stepCircle.classList.add(isCompleted ? 'completed-step' : 'bg-white', isCompleted ? 'text-white' : 'upcoming-step', 'border-2');

                const stepIcon = document.createElement('span');
                stepIcon.classList.add('text-center', 'w-full');
                if (isCompleted) {
                    stepIcon.innerHTML = '<i class="fa fa-check"></i>';
                } else {
                    stepIcon.textContent = index + 1;
                    stepIcon.classList.add('text-grey-darker');
                }

                stepCircle.appendChild(stepIcon);
                stepDiv.appendChild(stepCircle);
                progressSteps.appendChild(stepDiv);

                // Create progress bar
                if (index < data.length - 1) {
                    const barContainer = document.createElement('div');
                    barContainer.classList.add('w-1/6', 'align-center', 'items-center', 'align-middle', 'content-center', 'flex');

                    const barWrapper = document.createElement('div');
                    barWrapper.classList.add('w-full', 'rounded', 'items-center', 'align-middle', 'align-center', 'flex-1', 'bg-grey-light');

                    const progressBar = document.createElement('div');
                    progressBar.classList.add('progress-bar', 'text-xs', 'leading-none', 'py-1', 'text-center', 'text-grey-darkest', 'rounded');
                    progressBar.classList.add(isCompleted ? 'completed-bar' : 'upcoming-bar');
                    progressBar.style.width = isCompleted ? '100%' : `${(currentPoints / accumulatedPoints) * 100}%`;

                    barWrapper.appendChild(progressBar);
                    barContainer.appendChild(barWrapper);
                    progressSteps.appendChild(barContainer);
                }

                // Create progress label
                const labelDiv = document.createElement('div');
                labelDiv.classList.add('w-1/4');
                labelDiv.textContent = level.name;
                progressLabels.appendChild(labelDiv);
            });
        }

        // Example usage: generating the progress bar with current points
        generateProgressBar(data, 150); // You can change 600 to any other points value to test
    </script>
</body>
</html>